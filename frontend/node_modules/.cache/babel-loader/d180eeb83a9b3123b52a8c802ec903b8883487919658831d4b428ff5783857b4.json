{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\fkuce\\\\OneDrive\\\\Desktop\\\\Money Projects\\\\Visualizer\\\\frontend\\\\src\\\\components\\\\Visualizer.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, forwardRef } from 'react';\nimport './Visualizer.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Visualizer = /*#__PURE__*/_s(/*#__PURE__*/forwardRef(_c = _s(({\n  audioFile,\n  template,\n  isPlaying\n}, ref) => {\n  _s();\n  const canvasRef = useRef(null);\n  const audioContextRef = useRef(null);\n  const analyserRef = useRef(null);\n  const animationFrameRef = useRef(null);\n  const sourceRef = useRef(null);\n  const audioElementRef = useRef(null);\n  useEffect(() => {\n    if (!audioFile) return;\n    const initAudio = async () => {\n      try {\n        // Create new audio context if it doesn't exist\n        if (!audioContextRef.current) {\n          audioContextRef.current = new (window.AudioContext || window.webkitAudioContext)();\n        }\n\n        // Create analyzer if it doesn't exist\n        if (!analyserRef.current) {\n          analyserRef.current = audioContextRef.current.createAnalyser();\n          analyserRef.current.fftSize = 2048;\n        }\n\n        // Disconnect any existing source\n        if (sourceRef.current) {\n          sourceRef.current.disconnect();\n          sourceRef.current = null;\n        }\n\n        // Create and set up audio element\n        const audioElement = new Audio();\n        audioElement.crossOrigin = \"anonymous\"; // Enable CORS\n        audioElementRef.current = audioElement;\n\n        // Set up error handling\n        audioElement.onerror = e => {\n          var _audioElement$error;\n          console.error('Audio element error:', e);\n          throw new Error(`Failed to load audio: ${((_audioElement$error = audioElement.error) === null || _audioElement$error === void 0 ? void 0 : _audioElement$error.message) || 'Unknown error'}`);\n        };\n\n        // Set the audio source with cache-busting\n        const timestamp = new Date().getTime();\n        audioElement.src = `http://localhost:5001${audioFile.path}?t=${timestamp}`;\n\n        // Wait for audio to be ready\n        await new Promise((resolve, reject) => {\n          const timeout = setTimeout(() => {\n            reject(new Error('Audio loading timed out'));\n          }, 10000);\n          const handleCanPlay = () => {\n            clearTimeout(timeout);\n            resolve();\n          };\n          audioElement.addEventListener('canplay', handleCanPlay, {\n            once: true\n          });\n          audioElement.addEventListener('error', e => {\n            var _audioElement$error2;\n            clearTimeout(timeout);\n            reject(new Error(`Audio loading failed: ${((_audioElement$error2 = audioElement.error) === null || _audioElement$error2 === void 0 ? void 0 : _audioElement$error2.message) || 'Unknown error'}`));\n          }, {\n            once: true\n          });\n\n          // Start loading the audio\n          audioElement.load();\n        });\n\n        // Resume audio context if it's suspended\n        if (audioContextRef.current.state === 'suspended') {\n          await audioContextRef.current.resume();\n        }\n\n        // Create and connect the media source\n        const mediaSource = audioContextRef.current.createMediaElementSource(audioElement);\n        sourceRef.current = mediaSource;\n        mediaSource.connect(analyserRef.current);\n        analyserRef.current.connect(audioContextRef.current.destination);\n\n        // Start playback if needed\n        if (isPlaying) {\n          try {\n            await audioElement.play();\n            startVisualization();\n          } catch (playError) {\n            console.error('Error playing audio:', playError);\n            throw new Error('Failed to play audio. Please try again.');\n          }\n        }\n        return () => {\n          if (audioElement) {\n            audioElement.pause();\n            audioElement.src = '';\n          }\n          if (sourceRef.current) {\n            sourceRef.current.disconnect();\n          }\n          cancelAnimationFrame(animationFrameRef.current);\n        };\n      } catch (error) {\n        console.error('Error initializing audio:', error);\n        alert(error.message || 'Error loading audio file. Please try a different file format or check if the file is corrupted.');\n      }\n    };\n    initAudio();\n  }, [audioFile, isPlaying]);\n  useEffect(() => {\n    if (!audioElementRef.current) return;\n    if (isPlaying) {\n      audioElementRef.current.play().catch(error => {\n        console.error('Error playing audio:', error);\n        alert('Failed to play audio. Please try again.');\n      });\n      startVisualization();\n    } else {\n      audioElementRef.current.pause();\n      cancelAnimationFrame(animationFrameRef.current);\n    }\n  }, [isPlaying]);\n  const startVisualization = () => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    const analyser = analyserRef.current;\n    const bufferLength = analyser.frequencyBinCount;\n    const dataArray = new Uint8Array(bufferLength);\n    const timeArray = new Uint8Array(bufferLength);\n\n    // For particles visualization\n    let particles = [];\n    if (template === 'particles' && particles.length === 0) {\n      initParticles();\n    }\n    const draw = () => {\n      animationFrameRef.current = requestAnimationFrame(draw);\n      analyser.getByteFrequencyData(dataArray);\n      analyser.getByteTimeDomainData(timeArray);\n      ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\n      switch (template) {\n        case 'waveform':\n          drawWaveform(ctx, dataArray, bufferLength);\n          break;\n        case 'bars':\n          drawBars(ctx, dataArray, bufferLength);\n          break;\n        case 'circles':\n          drawCircles(ctx, dataArray, bufferLength);\n          break;\n        case 'kaleidoscope':\n          drawKaleidoscope(ctx, dataArray, timeArray, bufferLength);\n          break;\n        case 'spiral':\n          drawSpiral(ctx, dataArray, timeArray, bufferLength);\n          break;\n        case 'particles':\n          updateAndDrawParticles(ctx, dataArray, bufferLength);\n          break;\n        default:\n          drawWaveform(ctx, dataArray, bufferLength);\n      }\n    };\n    draw();\n  };\n  const drawWaveform = (ctx, dataArray, bufferLength) => {\n    ctx.lineWidth = 2;\n    ctx.strokeStyle = 'rgb(0, 255, 0)';\n    ctx.beginPath();\n    const sliceWidth = ctx.canvas.width / bufferLength;\n    let x = 0;\n    for (let i = 0; i < bufferLength; i++) {\n      const v = dataArray[i] / 128.0;\n      const y = v * ctx.canvas.height / 2;\n      if (i === 0) {\n        ctx.moveTo(x, y);\n      } else {\n        ctx.lineTo(x, y);\n      }\n      x += sliceWidth;\n    }\n    ctx.lineTo(ctx.canvas.width, ctx.canvas.height / 2);\n    ctx.stroke();\n  };\n  const drawBars = (ctx, dataArray, bufferLength) => {\n    const barWidth = ctx.canvas.width / bufferLength * 2.5;\n    let barHeight;\n    let x = 0;\n    for (let i = 0; i < bufferLength; i++) {\n      barHeight = dataArray[i] / 2;\n      ctx.fillStyle = `rgb(${barHeight + 100}, 50, 50)`;\n      ctx.fillRect(x, ctx.canvas.height - barHeight, barWidth, barHeight);\n      x += barWidth + 1;\n    }\n  };\n  const drawCircles = (ctx, dataArray, bufferLength) => {\n    const centerX = ctx.canvas.width / 2;\n    const centerY = ctx.canvas.height / 2;\n    const maxRadius = Math.min(centerX, centerY) * 0.8;\n    for (let i = 0; i < bufferLength; i++) {\n      const radius = dataArray[i] / 255 * maxRadius;\n      const angle = i / bufferLength * Math.PI * 2;\n      const x = centerX + Math.cos(angle) * radius;\n      const y = centerY + Math.sin(angle) * radius;\n      ctx.beginPath();\n      ctx.arc(x, y, 2, 0, Math.PI * 2);\n      ctx.fillStyle = `hsl(${i / bufferLength * 360}, 100%, 50%)`;\n      ctx.fill();\n    }\n  };\n  const drawKaleidoscope = (ctx, dataArray, timeArray, bufferLength) => {\n    const centerX = ctx.canvas.width / 2;\n    const centerY = ctx.canvas.height / 2;\n    const segments = 8;\n    const angleStep = Math.PI * 2 / segments;\n\n    // Calculate average frequency for color\n    const avgFreq = dataArray.reduce((a, b) => a + b, 0) / bufferLength;\n    const hue = (avgFreq + performance.now() / 50) % 360;\n    ctx.save();\n    ctx.translate(centerX, centerY);\n    for (let s = 0; s < segments; s++) {\n      ctx.rotate(angleStep);\n      ctx.beginPath();\n      ctx.moveTo(0, 0);\n      for (let i = 0; i < bufferLength; i += 4) {\n        const freq = dataArray[i];\n        const time = timeArray[i];\n        const x = i / bufferLength * 200;\n        const y = freq / 256 * 200;\n        const wave = Math.sin(time / 128 * Math.PI + x / 50) * 20;\n        ctx.lineTo(x, y + wave);\n      }\n      ctx.strokeStyle = `hsl(${hue}, 100%, 50%)`;\n      ctx.lineWidth = 2;\n      ctx.stroke();\n\n      // Mirror effect\n      ctx.scale(-1, 1);\n    }\n    ctx.restore();\n  };\n  const drawSpiral = (ctx, dataArray, timeArray, bufferLength) => {\n    const centerX = ctx.canvas.width / 2;\n    const centerY = ctx.canvas.height / 2;\n    const maxRadius = Math.min(centerX, centerY) * 0.9;\n\n    // Calculate average frequency for effects\n    const avgFreq = dataArray.reduce((a, b) => a + b, 0) / bufferLength;\n    const time = performance.now() / 1000;\n    ctx.save();\n    ctx.translate(centerX, centerY);\n    for (let i = 0; i < bufferLength; i += 2) {\n      const freq = dataArray[i];\n      const amplitude = freq / 256;\n\n      // Create spiral effect\n      const angle = i / bufferLength * Math.PI * 20 + time;\n      const radius = i / bufferLength * maxRadius * (1 + amplitude * 0.2);\n      const x = Math.cos(angle) * radius;\n      const y = Math.sin(angle) * radius;\n      const hue = (angle * 30 + time * 50) % 360;\n      const size = 2 + amplitude * 5;\n      ctx.beginPath();\n      ctx.arc(x, y, size, 0, Math.PI * 2);\n      ctx.fillStyle = `hsla(${hue}, 100%, 50%, ${0.5 + amplitude * 0.5})`;\n      ctx.fill();\n\n      // Add connecting lines for more psychedelic effect\n      if (i > 0) {\n        const prevAngle = (i - 2) / bufferLength * Math.PI * 20 + time;\n        const prevRadius = (i - 2) / bufferLength * maxRadius;\n        const prevX = Math.cos(prevAngle) * prevRadius;\n        const prevY = Math.sin(prevAngle) * prevRadius;\n        ctx.beginPath();\n        ctx.moveTo(prevX, prevY);\n        ctx.lineTo(x, y);\n        ctx.strokeStyle = `hsla(${hue}, 100%, 50%, 0.3)`;\n        ctx.lineWidth = 1;\n        ctx.stroke();\n      }\n    }\n    ctx.restore();\n  };\n  const initParticles = () => {\n    particles = [];\n    const numParticles = 100;\n    for (let i = 0; i < numParticles; i++) {\n      particles.push({\n        x: Math.random() * ctx.canvas.width,\n        y: Math.random() * ctx.canvas.height,\n        size: Math.random() * 4 + 2,\n        speedX: Math.random() * 4 - 2,\n        speedY: Math.random() * 4 - 2,\n        hue: Math.random() * 360\n      });\n    }\n  };\n  const updateAndDrawParticles = (ctx, dataArray, bufferLength) => {\n    const avgFreq = dataArray.reduce((a, b) => a + b, 0) / bufferLength;\n    const intensity = avgFreq / 256;\n    particles.forEach((particle, i) => {\n      // Update position\n      particle.x += particle.speedX * (1 + intensity);\n      particle.y += particle.speedY * (1 + intensity);\n\n      // Wrap around screen\n      if (particle.x < 0) particle.x = ctx.canvas.width;\n      if (particle.x > ctx.canvas.width) particle.x = 0;\n      if (particle.y < 0) particle.y = ctx.canvas.height;\n      if (particle.y > ctx.canvas.height) particle.y = 0;\n\n      // Update color based on frequency\n      const freqIndex = Math.floor(i / particles.length * bufferLength);\n      const freq = dataArray[freqIndex];\n      const hue = (particle.hue + freq / 2) % 360;\n\n      // Draw particle\n      ctx.beginPath();\n      ctx.arc(particle.x, particle.y, particle.size * (1 + intensity * 0.5), 0, Math.PI * 2);\n      ctx.fillStyle = `hsla(${hue}, 100%, 50%, ${0.7 + intensity * 0.3})`;\n      ctx.fill();\n\n      // Draw connections\n      particles.forEach((otherParticle, j) => {\n        if (i === j) return;\n        const dx = particle.x - otherParticle.x;\n        const dy = particle.y - otherParticle.y;\n        const distance = Math.sqrt(dx * dx + dy * dy);\n        if (distance < 100) {\n          ctx.beginPath();\n          ctx.moveTo(particle.x, particle.y);\n          ctx.lineTo(otherParticle.x, otherParticle.y);\n          ctx.strokeStyle = `hsla(${hue}, 100%, 50%, ${(1 - distance / 100) * 0.2})`;\n          ctx.lineWidth = 1;\n          ctx.stroke();\n        }\n      });\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"canvas\", {\n    ref: el => {\n      canvasRef.current = el;\n      if (ref) ref.current = el;\n    },\n    className: \"visualizer-canvas\",\n    width: 800,\n    height: 400\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 395,\n    columnNumber: 5\n  }, this);\n}, \"rvV19nucqVbPjLjn4y1TSZ+KrIc=\")), \"rvV19nucqVbPjLjn4y1TSZ+KrIc=\");\n_c2 = Visualizer;\nexport default Visualizer;\nvar _c, _c2;\n$RefreshReg$(_c, \"Visualizer$forwardRef\");\n$RefreshReg$(_c2, \"Visualizer\");","map":{"version":3,"names":["React","useEffect","useRef","forwardRef","jsxDEV","_jsxDEV","Visualizer","_s","_c","audioFile","template","isPlaying","ref","canvasRef","audioContextRef","analyserRef","animationFrameRef","sourceRef","audioElementRef","initAudio","current","window","AudioContext","webkitAudioContext","createAnalyser","fftSize","disconnect","audioElement","Audio","crossOrigin","onerror","e","_audioElement$error","console","error","Error","message","timestamp","Date","getTime","src","path","Promise","resolve","reject","timeout","setTimeout","handleCanPlay","clearTimeout","addEventListener","once","_audioElement$error2","load","state","resume","mediaSource","createMediaElementSource","connect","destination","play","startVisualization","playError","pause","cancelAnimationFrame","alert","catch","canvas","ctx","getContext","analyser","bufferLength","frequencyBinCount","dataArray","Uint8Array","timeArray","particles","length","initParticles","draw","requestAnimationFrame","getByteFrequencyData","getByteTimeDomainData","fillStyle","fillRect","width","height","drawWaveform","drawBars","drawCircles","drawKaleidoscope","drawSpiral","updateAndDrawParticles","lineWidth","strokeStyle","beginPath","sliceWidth","x","i","v","y","moveTo","lineTo","stroke","barWidth","barHeight","centerX","centerY","maxRadius","Math","min","radius","angle","PI","cos","sin","arc","fill","segments","angleStep","avgFreq","reduce","a","b","hue","performance","now","save","translate","s","rotate","freq","time","wave","scale","restore","amplitude","size","prevAngle","prevRadius","prevX","prevY","numParticles","push","random","speedX","speedY","intensity","forEach","particle","freqIndex","floor","otherParticle","j","dx","dy","distance","sqrt","el","className","fileName","_jsxFileName","lineNumber","columnNumber","_c2","$RefreshReg$"],"sources":["C:/Users/fkuce/OneDrive/Desktop/Money Projects/Visualizer/frontend/src/components/Visualizer.js"],"sourcesContent":["import React, { useEffect, useRef, forwardRef } from 'react';\r\nimport './Visualizer.css';\r\n\r\nconst Visualizer = forwardRef(({ audioFile, template, isPlaying }, ref) => {\r\n  const canvasRef = useRef(null);\r\n  const audioContextRef = useRef(null);\r\n  const analyserRef = useRef(null);\r\n  const animationFrameRef = useRef(null);\r\n  const sourceRef = useRef(null);\r\n  const audioElementRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (!audioFile) return;\r\n\r\n    const initAudio = async () => {\r\n      try {\r\n        // Create new audio context if it doesn't exist\r\n        if (!audioContextRef.current) {\r\n          audioContextRef.current = new (window.AudioContext || window.webkitAudioContext)();\r\n        }\r\n\r\n        // Create analyzer if it doesn't exist\r\n        if (!analyserRef.current) {\r\n          analyserRef.current = audioContextRef.current.createAnalyser();\r\n          analyserRef.current.fftSize = 2048;\r\n        }\r\n\r\n        // Disconnect any existing source\r\n        if (sourceRef.current) {\r\n          sourceRef.current.disconnect();\r\n          sourceRef.current = null;\r\n        }\r\n\r\n        // Create and set up audio element\r\n        const audioElement = new Audio();\r\n        audioElement.crossOrigin = \"anonymous\"; // Enable CORS\r\n        audioElementRef.current = audioElement;\r\n\r\n        // Set up error handling\r\n        audioElement.onerror = (e) => {\r\n          console.error('Audio element error:', e);\r\n          throw new Error(`Failed to load audio: ${audioElement.error?.message || 'Unknown error'}`);\r\n        };\r\n\r\n        // Set the audio source with cache-busting\r\n        const timestamp = new Date().getTime();\r\n        audioElement.src = `http://localhost:5001${audioFile.path}?t=${timestamp}`;\r\n\r\n        // Wait for audio to be ready\r\n        await new Promise((resolve, reject) => {\r\n          const timeout = setTimeout(() => {\r\n            reject(new Error('Audio loading timed out'));\r\n          }, 10000);\r\n\r\n          const handleCanPlay = () => {\r\n            clearTimeout(timeout);\r\n            resolve();\r\n          };\r\n\r\n          audioElement.addEventListener('canplay', handleCanPlay, { once: true });\r\n          audioElement.addEventListener('error', (e) => {\r\n            clearTimeout(timeout);\r\n            reject(new Error(`Audio loading failed: ${audioElement.error?.message || 'Unknown error'}`));\r\n          }, { once: true });\r\n\r\n          // Start loading the audio\r\n          audioElement.load();\r\n        });\r\n\r\n        // Resume audio context if it's suspended\r\n        if (audioContextRef.current.state === 'suspended') {\r\n          await audioContextRef.current.resume();\r\n        }\r\n\r\n        // Create and connect the media source\r\n        const mediaSource = audioContextRef.current.createMediaElementSource(audioElement);\r\n        sourceRef.current = mediaSource;\r\n        \r\n        mediaSource.connect(analyserRef.current);\r\n        analyserRef.current.connect(audioContextRef.current.destination);\r\n\r\n        // Start playback if needed\r\n        if (isPlaying) {\r\n          try {\r\n            await audioElement.play();\r\n            startVisualization();\r\n          } catch (playError) {\r\n            console.error('Error playing audio:', playError);\r\n            throw new Error('Failed to play audio. Please try again.');\r\n          }\r\n        }\r\n\r\n        return () => {\r\n          if (audioElement) {\r\n            audioElement.pause();\r\n            audioElement.src = '';\r\n          }\r\n          if (sourceRef.current) {\r\n            sourceRef.current.disconnect();\r\n          }\r\n          cancelAnimationFrame(animationFrameRef.current);\r\n        };\r\n      } catch (error) {\r\n        console.error('Error initializing audio:', error);\r\n        alert(error.message || 'Error loading audio file. Please try a different file format or check if the file is corrupted.');\r\n      }\r\n    };\r\n\r\n    initAudio();\r\n  }, [audioFile, isPlaying]);\r\n\r\n  useEffect(() => {\r\n    if (!audioElementRef.current) return;\r\n\r\n    if (isPlaying) {\r\n      audioElementRef.current.play().catch(error => {\r\n        console.error('Error playing audio:', error);\r\n        alert('Failed to play audio. Please try again.');\r\n      });\r\n      startVisualization();\r\n    } else {\r\n      audioElementRef.current.pause();\r\n      cancelAnimationFrame(animationFrameRef.current);\r\n    }\r\n  }, [isPlaying]);\r\n\r\n  const startVisualization = () => {\r\n    const canvas = canvasRef.current;\r\n    const ctx = canvas.getContext('2d');\r\n    const analyser = analyserRef.current;\r\n    const bufferLength = analyser.frequencyBinCount;\r\n    const dataArray = new Uint8Array(bufferLength);\r\n    const timeArray = new Uint8Array(bufferLength);\r\n\r\n    // For particles visualization\r\n    let particles = [];\r\n    if (template === 'particles' && particles.length === 0) {\r\n      initParticles();\r\n    }\r\n\r\n    const draw = () => {\r\n      animationFrameRef.current = requestAnimationFrame(draw);\r\n      analyser.getByteFrequencyData(dataArray);\r\n      analyser.getByteTimeDomainData(timeArray);\r\n\r\n      ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';\r\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n      switch (template) {\r\n        case 'waveform':\r\n          drawWaveform(ctx, dataArray, bufferLength);\r\n          break;\r\n        case 'bars':\r\n          drawBars(ctx, dataArray, bufferLength);\r\n          break;\r\n        case 'circles':\r\n          drawCircles(ctx, dataArray, bufferLength);\r\n          break;\r\n        case 'kaleidoscope':\r\n          drawKaleidoscope(ctx, dataArray, timeArray, bufferLength);\r\n          break;\r\n        case 'spiral':\r\n          drawSpiral(ctx, dataArray, timeArray, bufferLength);\r\n          break;\r\n        case 'particles':\r\n          updateAndDrawParticles(ctx, dataArray, bufferLength);\r\n          break;\r\n        default:\r\n          drawWaveform(ctx, dataArray, bufferLength);\r\n      }\r\n    };\r\n\r\n    draw();\r\n  };\r\n\r\n  const drawWaveform = (ctx, dataArray, bufferLength) => {\r\n    ctx.lineWidth = 2;\r\n    ctx.strokeStyle = 'rgb(0, 255, 0)';\r\n    ctx.beginPath();\r\n\r\n    const sliceWidth = ctx.canvas.width / bufferLength;\r\n    let x = 0;\r\n\r\n    for (let i = 0; i < bufferLength; i++) {\r\n      const v = dataArray[i] / 128.0;\r\n      const y = v * ctx.canvas.height / 2;\r\n\r\n      if (i === 0) {\r\n        ctx.moveTo(x, y);\r\n      } else {\r\n        ctx.lineTo(x, y);\r\n      }\r\n\r\n      x += sliceWidth;\r\n    }\r\n\r\n    ctx.lineTo(ctx.canvas.width, ctx.canvas.height / 2);\r\n    ctx.stroke();\r\n  };\r\n\r\n  const drawBars = (ctx, dataArray, bufferLength) => {\r\n    const barWidth = (ctx.canvas.width / bufferLength) * 2.5;\r\n    let barHeight;\r\n    let x = 0;\r\n\r\n    for (let i = 0; i < bufferLength; i++) {\r\n      barHeight = dataArray[i] / 2;\r\n\r\n      ctx.fillStyle = `rgb(${barHeight + 100}, 50, 50)`;\r\n      ctx.fillRect(x, ctx.canvas.height - barHeight, barWidth, barHeight);\r\n\r\n      x += barWidth + 1;\r\n    }\r\n  };\r\n\r\n  const drawCircles = (ctx, dataArray, bufferLength) => {\r\n    const centerX = ctx.canvas.width / 2;\r\n    const centerY = ctx.canvas.height / 2;\r\n    const maxRadius = Math.min(centerX, centerY) * 0.8;\r\n\r\n    for (let i = 0; i < bufferLength; i++) {\r\n      const radius = (dataArray[i] / 255) * maxRadius;\r\n      const angle = (i / bufferLength) * Math.PI * 2;\r\n\r\n      const x = centerX + Math.cos(angle) * radius;\r\n      const y = centerY + Math.sin(angle) * radius;\r\n\r\n      ctx.beginPath();\r\n      ctx.arc(x, y, 2, 0, Math.PI * 2);\r\n      ctx.fillStyle = `hsl(${(i / bufferLength) * 360}, 100%, 50%)`;\r\n      ctx.fill();\r\n    }\r\n  };\r\n\r\n  const drawKaleidoscope = (ctx, dataArray, timeArray, bufferLength) => {\r\n    const centerX = ctx.canvas.width / 2;\r\n    const centerY = ctx.canvas.height / 2;\r\n    const segments = 8;\r\n    const angleStep = (Math.PI * 2) / segments;\r\n    \r\n    // Calculate average frequency for color\r\n    const avgFreq = dataArray.reduce((a, b) => a + b, 0) / bufferLength;\r\n    const hue = (avgFreq + performance.now() / 50) % 360;\r\n    \r\n    ctx.save();\r\n    ctx.translate(centerX, centerY);\r\n\r\n    for (let s = 0; s < segments; s++) {\r\n      ctx.rotate(angleStep);\r\n      \r\n      ctx.beginPath();\r\n      ctx.moveTo(0, 0);\r\n      \r\n      for (let i = 0; i < bufferLength; i += 4) {\r\n        const freq = dataArray[i];\r\n        const time = timeArray[i];\r\n        const x = (i / bufferLength) * 200;\r\n        const y = (freq / 256) * 200;\r\n        \r\n        const wave = Math.sin(time / 128 * Math.PI + x / 50) * 20;\r\n        \r\n        ctx.lineTo(x, y + wave);\r\n      }\r\n      \r\n      ctx.strokeStyle = `hsl(${hue}, 100%, 50%)`;\r\n      ctx.lineWidth = 2;\r\n      ctx.stroke();\r\n      \r\n      // Mirror effect\r\n      ctx.scale(-1, 1);\r\n    }\r\n    \r\n    ctx.restore();\r\n  };\r\n\r\n  const drawSpiral = (ctx, dataArray, timeArray, bufferLength) => {\r\n    const centerX = ctx.canvas.width / 2;\r\n    const centerY = ctx.canvas.height / 2;\r\n    const maxRadius = Math.min(centerX, centerY) * 0.9;\r\n    \r\n    // Calculate average frequency for effects\r\n    const avgFreq = dataArray.reduce((a, b) => a + b, 0) / bufferLength;\r\n    const time = performance.now() / 1000;\r\n    \r\n    ctx.save();\r\n    ctx.translate(centerX, centerY);\r\n    \r\n    for (let i = 0; i < bufferLength; i += 2) {\r\n      const freq = dataArray[i];\r\n      const amplitude = freq / 256;\r\n      \r\n      // Create spiral effect\r\n      const angle = (i / bufferLength) * Math.PI * 20 + time;\r\n      const radius = (i / bufferLength) * maxRadius * (1 + amplitude * 0.2);\r\n      \r\n      const x = Math.cos(angle) * radius;\r\n      const y = Math.sin(angle) * radius;\r\n      \r\n      const hue = (angle * 30 + time * 50) % 360;\r\n      const size = 2 + amplitude * 5;\r\n      \r\n      ctx.beginPath();\r\n      ctx.arc(x, y, size, 0, Math.PI * 2);\r\n      ctx.fillStyle = `hsla(${hue}, 100%, 50%, ${0.5 + amplitude * 0.5})`;\r\n      ctx.fill();\r\n      \r\n      // Add connecting lines for more psychedelic effect\r\n      if (i > 0) {\r\n        const prevAngle = ((i - 2) / bufferLength) * Math.PI * 20 + time;\r\n        const prevRadius = ((i - 2) / bufferLength) * maxRadius;\r\n        const prevX = Math.cos(prevAngle) * prevRadius;\r\n        const prevY = Math.sin(prevAngle) * prevRadius;\r\n        \r\n        ctx.beginPath();\r\n        ctx.moveTo(prevX, prevY);\r\n        ctx.lineTo(x, y);\r\n        ctx.strokeStyle = `hsla(${hue}, 100%, 50%, 0.3)`;\r\n        ctx.lineWidth = 1;\r\n        ctx.stroke();\r\n      }\r\n    }\r\n    \r\n    ctx.restore();\r\n  };\r\n\r\n  const initParticles = () => {\r\n    particles = [];\r\n    const numParticles = 100;\r\n    \r\n    for (let i = 0; i < numParticles; i++) {\r\n      particles.push({\r\n        x: Math.random() * ctx.canvas.width,\r\n        y: Math.random() * ctx.canvas.height,\r\n        size: Math.random() * 4 + 2,\r\n        speedX: Math.random() * 4 - 2,\r\n        speedY: Math.random() * 4 - 2,\r\n        hue: Math.random() * 360\r\n      });\r\n    }\r\n  };\r\n\r\n  const updateAndDrawParticles = (ctx, dataArray, bufferLength) => {\r\n    const avgFreq = dataArray.reduce((a, b) => a + b, 0) / bufferLength;\r\n    const intensity = avgFreq / 256;\r\n    \r\n    particles.forEach((particle, i) => {\r\n      // Update position\r\n      particle.x += particle.speedX * (1 + intensity);\r\n      particle.y += particle.speedY * (1 + intensity);\r\n      \r\n      // Wrap around screen\r\n      if (particle.x < 0) particle.x = ctx.canvas.width;\r\n      if (particle.x > ctx.canvas.width) particle.x = 0;\r\n      if (particle.y < 0) particle.y = ctx.canvas.height;\r\n      if (particle.y > ctx.canvas.height) particle.y = 0;\r\n      \r\n      // Update color based on frequency\r\n      const freqIndex = Math.floor((i / particles.length) * bufferLength);\r\n      const freq = dataArray[freqIndex];\r\n      const hue = (particle.hue + freq / 2) % 360;\r\n      \r\n      // Draw particle\r\n      ctx.beginPath();\r\n      ctx.arc(\r\n        particle.x,\r\n        particle.y,\r\n        particle.size * (1 + intensity * 0.5),\r\n        0,\r\n        Math.PI * 2\r\n      );\r\n      ctx.fillStyle = `hsla(${hue}, 100%, 50%, ${0.7 + intensity * 0.3})`;\r\n      ctx.fill();\r\n      \r\n      // Draw connections\r\n      particles.forEach((otherParticle, j) => {\r\n        if (i === j) return;\r\n        \r\n        const dx = particle.x - otherParticle.x;\r\n        const dy = particle.y - otherParticle.y;\r\n        const distance = Math.sqrt(dx * dx + dy * dy);\r\n        \r\n        if (distance < 100) {\r\n          ctx.beginPath();\r\n          ctx.moveTo(particle.x, particle.y);\r\n          ctx.lineTo(otherParticle.x, otherParticle.y);\r\n          ctx.strokeStyle = `hsla(${hue}, 100%, 50%, ${(1 - distance / 100) * 0.2})`;\r\n          ctx.lineWidth = 1;\r\n          ctx.stroke();\r\n        }\r\n      });\r\n    });\r\n  };\r\n\r\n  return (\r\n    <canvas\r\n      ref={(el) => {\r\n        canvasRef.current = el;\r\n        if (ref) ref.current = el;\r\n      }}\r\n      className=\"visualizer-canvas\"\r\n      width={800}\r\n      height={400}\r\n    />\r\n  );\r\n});\r\n\r\nexport default Visualizer; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}